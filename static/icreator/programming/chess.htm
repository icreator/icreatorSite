<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>Логическое программирование</TITLE>
</HEAD>
<BODY BGCOLOR="#cdc6a7">

<FONT FACE="Courier New"><P>Расстановка шахматных фигур на шахматной доске</P>
<P><BR>
Ермолаев Д.С., Москва, </FONT><A HREF="http://www.icreator.ru/index.htm"><U><FONT FACE="Courier New" SIZE=1 COLOR="#0000ff">www.icreator.ru</U></FONT></A></P>
<FONT FACE="Courier New"><P>Программа на ПРОЛОГе расставляет шахматные фигуры на шахматной доске, так чтобы не было побита поставленная фигура другими фигурами или другие фигуры не были побиты поставленной фигурой. Здесь нет математических вычислений для определения нахождения боя фигурами. Используются только факты и работа с ними. Другими словами программа “видит” шахматное поле подобно человеку. Программа сделана была мною за 5 часов, включая разработку алгоритма и интерфейса на Visual Prolog 5.2. Из-за того что вместо вычисления положения идет перебор фактов, скорость работы программы очень низкая -–секунд 30 на процессоре с 800МГц. Однако это гораздо быстрее чем “думает” человек!</P>
</FONT><PRE>------------------------------------

<B><FONT COLOR="#0000ff">Global domains
</B></FONT>
<FONT FACE="Courier New">ФФФ = король; ферзь; слон; конь; ладья 
Угол = наискось; прямо 
Дальность = линия; рядом; конём
Бъёт = бъёт(Дальность,Угол); конём
Строка = string
Строки = Строка*
Поле = поле(Строка,Строка)
</FONT>
<B><FONT COLOR="#0000ff">Global predicates
</B></FONT><FONT FACE="Courier New">поставить_фигуры(ФФФ)
</FONT>
<B><FONT COLOR="#0000ff">predicates
</B></FONT><FONT FACE="Courier New">nondeterm правило(ФФФ,Бъёт)
разметка1(Строки)
разметка2(Строки)
</FONT>
<B><FONT COLOR="#0000ff">clauses
</B></FONT><FONT FACE="Courier New" COLOR="#008000">% правила боя фигур
</FONT><FONT FACE="Courier New">правило(король,бъёт(рядом,наискось)).
правило(король,бъёт(рядом,прямо)).
правило(ферзь,бъёт(линия,наискось)).
правило(ферзь,бъёт(линия,прямо)).
правило(слон,бъёт(линия,наискось)).
правило(конь,конём).
правило(ладья,бъёт(линия,прямо)).
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% размеры доски по вертикали и по горизонтали
</FONT><FONT FACE="Courier New">разметка1(["1","2","3","4","5","6","7","8","9","10"]).
разметка2(["a","b","c","d","e","f","g","i","k","l"]).
</FONT>
<B><FONT FACE="Courier New" COLOR="#0000ff">database - расстановки
</B></FONT><FONT FACE="Courier New" COLOR="#008000">% факт -  места где стоят фигуры
</FONT><FONT FACE="Courier New">стоит(ФФФ,Поле)
</FONT>
<B><FONT COLOR="#0000ff">domains
</B></FONT><FONT FACE="Courier New">Напр = влево; вправо; вверх; вниз; вниз_влево; вниз_вправо;
&#9;вверх_влево; вверх_вправо
</FONT>
<FONT COLOR="#008000">%
</FONT><FONT FACE="Courier New" COLOR="#008000">% служебные процедуры перебора клеток
% для "понимания" правил компьютером
% заметьте, здесь "понимание" идет такое же как и человеком
% и нет ни одной математической операции.
% все построено на фактах
</FONT><FONT COLOR="#008000">%
</FONT><B><FONT COLOR="#0000ff">predicates
</B></FONT><FONT FACE="Courier New">nondeterm перебор_списка_как_фактов(Строки,Строка).
элемент_слева(Строки,Строка Элемент, Строка ЭлементСлева)
элемент_справа(Строки,Строка Элемент, Строка ЭлементСправа)
поле_слева(Поле, Поле Находим)
поле_справа(Поле, Поле Находим)
поле_сверху(Поле, Поле Находим)
поле_снизу(Поле, Поле Находим)
поле_рядом(Угол,Поле,Поле Рядом)
</FONT>nond<FONT FACE="Courier New">eterm поле_рядом(Угол,Напр,Поле,Поле Рядом)
поле_линия(Угол,Поле,Поле Линия)
поле_коня(Угол,Поле Из, Поле)
</FONT>
<B><FONT COLOR="#0000ff">clauses
</B></FONT><FONT FACE="Courier New" COLOR="#008000">% перебирает элементы списка как факты базы ПРОЛОГа
% это позволяет включить механизм отката
</FONT><FONT FACE="Courier New">перебор_списка_как_фактов([Строка|_],Строка).
перебор_списка_как_фактов([_|Строки],Строка):-
&#9;перебор_списка_как_фактов(Строки,Строка).
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% найдет элемент слева от данного в списке
</FONT><FONT FACE="Courier New">элемент_слева([ЭлементСлева,Элемент|_],Элемент,ЭлементСлева):-
</FONT>&#9;!.
<FONT FACE="Courier New">элемент_слева([_|Список],Элемент,ЭлементСлева):-
&#9;элемент_слева(Список,Элемент,ЭлементСлева),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% найдет элемент справа от данного в списке
</FONT><FONT FACE="Courier New">элемент_справа([Элемент,ЭлементСправа|_],Элемент,ЭлементСправа):-
</FONT>&#9;!.
<FONT FACE="Courier New">элемент_справа([_|Список],Элемент,ЭлементСправа):-
&#9;элемент_справа(Список,Элемент,ЭлементСправа),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% берет поле рядом
</FONT><FONT FACE="Courier New">поле_слева(поле(Число,Буква),поле(ЧислоСлева,Буква)):-
&#9;разметка1(Числа),
&#9;элемент_слева(Числа,Число,ЧислоСлева),
</FONT>&#9;!.
<FONT FACE="Courier New">поле_справа(поле(Число,Буква),поле(ЧислоСправа,Буква)):-
&#9;разметка1(Числа),
&#9;элемент_справа(Числа,Число,ЧислоСправа),
</FONT>&#9;!.
<FONT FACE="Courier New">поле_сверху(поле(Число,Буква),поле(Число,БукваСверху)):-
&#9;разметка2(Буквы),
&#9;элемент_слева(Буквы,Буква,БукваСверху),
</FONT>&#9;!.
<FONT FACE="Courier New">поле_снизу(поле(Число,Буква),поле(Число,БукваСнизу)):-
&#9;разметка2(Буквы),
&#9;элемент_справа(Буквы,Буква,БукваСнизу),
</FONT>&#9;!.

<FONT FACE="Courier New" COLOR="#008000">% перебирает все поля рядом в соответствии с углом боя
</FONT><FONT FACE="Courier New">поле_рядом(прямо,Поле,Поле1):-
&#9;поле_слева(Поле,Поле1),!.
поле_рядом(прямо,Поле,Поле1):-
&#9;поле_справа(Поле,Поле1),!.
поле_рядом(прямо,Поле,Поле1):-
&#9;поле_сверху(Поле,Поле1),!.
поле_рядом(прямо,Поле,Поле1):-
&#9;поле_снизу(Поле,Поле1),!.
</FONT><FONT FACE="Courier New" COLOR="#008000">% то же, но поля рядом с углом боя “наискось”
</FONT><FONT FACE="Courier New">поле_рядом(наискось,Поле,Поле1):-
&#9;поле_слева(Поле,Поле0),
&#9;поле_снизу(Поле0,Поле1),!.
поле_рядом(наискось,Поле,Поле1):-
&#9;поле_справа(Поле,Поле0),
&#9;поле_снизу(Поле0,Поле1),!.
поле_рядом(наискось,Поле,Поле1):-
&#9;поле_слева(Поле,Поле0),
&#9;поле_сверху(Поле0,Поле1),!.
поле_рядом(наискось,Поле,Поле1):-
&#9;поле_справа(Поле,Поле0),
&#9;поле_сверху(Поле0,Поле1),!.
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% перебор всех полей по линии боя
</FONT><FONT FACE="Courier New">поле_рядом(прямо,влево,Поле,Поле1):-
&#9;поле_слева(Поле,Поле1).
поле_рядом(прямо,влево,Поле,Поле1):-
&#9;поле_слева(Поле,Поле0),
&#9;поле_рядом(прямо,влево,Поле0,Поле1).
поле_рядом(прямо,вправо,Поле,Поле1):-
&#9;поле_справа(Поле,Поле1).
поле_рядом(прямо,вправо,Поле,Поле1):-
&#9;поле_справа(Поле,Поле0),
&#9;поле_рядом(прямо,вправо,Поле0,Поле1).
поле_рядом(прямо,вверх,Поле,Поле1):-
&#9;поле_сверху(Поле,Поле1).
поле_рядом(прямо,вверх,Поле,Поле1):-
&#9;поле_сверху(Поле,Поле0),
&#9;поле_рядом(прямо,вверх,Поле0,Поле1).
поле_рядом(прямо,вниз,Поле,Поле1):-
&#9;поле_снизу(Поле,Поле1).
поле_рядом(прямо,вниз,Поле,Поле1):-
&#9;поле_снизу(Поле,Поле0),
&#9;поле_рядом(прямо,вниз,Поле0,Поле1).
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% перебор всех полей по линии боя “наискось”
</FONT><FONT FACE="Courier New">поле_рядом(наискось,вниз_влево,Поле,Поле1):-
&#9;поле_слева(Поле,Поле0),
&#9;поле_снизу(Поле0,Поле1).
поле_рядом(наискось,вниз_влево,Поле,Поле1):-
&#9;поле_слева(Поле,Поле0),
&#9;поле_снизу(Поле0,Поле2),
&#9;поле_рядом(наискось,вниз_влево,Поле2,Поле1).
поле_рядом(наискось,вниз_вправо,Поле,Поле1):-
&#9;поле_справа(Поле,Поле0),
&#9;поле_снизу(Поле0,Поле1).
поле_рядом(наискось,вниз_вправо,Поле,Поле1):-
&#9;поле_справа(Поле,Поле0),
&#9;поле_снизу(Поле0,Поле2),
&#9;поле_рядом(наискось,вниз_вправо,Поле2,Поле1).
поле_рядом(наискось,вверх_влево,Поле,Поле1):-
&#9;поле_слева(Поле,Поле0),
&#9;поле_сверху(Поле0,Поле1).
поле_рядом(наискось,вверх_влево,Поле,Поле1):-
&#9;поле_слева(Поле,Поле0),
&#9;поле_сверху(Поле0,Поле2),
&#9;поле_рядом(наискось,вверх_влево,Поле2,Поле1).
поле_рядом(наискось,вверх_вправо,Поле,Поле1):-
&#9;поле_справа(Поле,Поле0),
&#9;поле_сверху(Поле0,Поле1).
поле_рядом(наискось,вверх_вправо,Поле,Поле1):-
&#9;поле_справа(Поле,Поле0</FONT>),
<FONT FACE="Courier New">&#9;поле_сверху(Поле0,Поле2),
&#9;поле_рядом(наискось,вверх_вправо,Поле2,Поле1).
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% если поля находятся на линии боя
</FONT><FONT FACE="Courier New">поле_линия(прямо,Поле,Поле1):-
&#9;поле_рядом(прямо,влево,Поле,Поле1),!.
поле_линия(прямо,Поле,Поле1):-
&#9;поле_рядом(прямо,вправо,Поле,Поле1),!.
поле_линия(прямо,Поле,Поле1):-
&#9;поле_рядом(прямо,вниз,Поле,Поле1),!.
поле_линия(прямо,Поле,Поле1):-
&#9;поле_рядом(прямо,вверх,Поле,Поле1),!.
поле_линия(наискось,Поле,Поле1):-
&#9;поле_рядом(наискось,вверх_вправо,Поле,Поле1),!.
поле_линия(наискось,Поле,Поле1):-
</FONT>&#9;<FONT FACE="Courier New">поле_рядом(наискось,вверх_влево,Поле,Поле1),!.
поле_линия(наискось,Поле,Поле1):-
&#9;поле_рядом(наискось,вниз_вправо,Поле,Поле1),!.
поле_линия(наискось,Поле,Поле1):-
&#9;поле_рядом(наискось,вниз_влево,Поле,Поле1),!.
</FONT>
<FONT FACE="Courier New">поле_коня(Напр,ПолеИз,Поле):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% пропущено %
</FONT>&#9; !.
 
<FONT COLOR="#008000">%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</FONT><FONT FACE="Courier New" COLOR="#008000">% сам механизм выбора полей 
</FONT><FONT COLOR="#008000">%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</FONT><B><FONT COLOR="#0000ff">predicates
</B></FONT><FONT FACE="Courier New">фигура_под_боем2(Поле Из,Бъёт,Поле)
фигура_под_боем1(Поле Из,Бъёт,Поле)
фигура_под_боем(ФФФ,Поле)
фигуры_не_под_боем(ФФФ,Поле)
nondeterm выбрать_поле_на_доске(Поле)
поставить_фигуры1(ФФФ)
поставить_фигуру(ФФФ)
</FONT>
<B><FONT COLOR="#0000ff">clauses
</B></FONT><FONT FACE="Courier New" COLOR="#008000">% берёт клетку на доске, в которую еще не ставили
% фигуру
</FONT><FONT FACE="Courier New">выбрать_поле_на_доске(поле(Число,Буква)):-
&#9;разметка1(Числа),
&#9;разметка2(Буквы),
&#9;перебор_списка_как_фактов(Числа,Число),
&#9;перебор_списка_как_фактов(Буквы,Буква).
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% определяет – стоят ли две фигуры под боем
</FONT><FONT COLOR="#008000">%
</FONT><FONT FACE="Courier New" COLOR="#008000">% если это место уже занято
</FONT><FONT FACE="Courier New">фигура_под_боем2(Поле,_,Поле):-!.
фигура_под_боем2(ПолеИз,бъёт(рядом,Напр),Поле):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% если фигура стоит рядом и по направлению боя
</FONT><FONT FACE="Courier New">&#9;поле_рядом(Напр,ПолеИз,Поле),
</FONT>&#9;!.
<FONT FACE="Courier New">фигура_под_боем2(ПолеИз,бъёт(линия,Напр),Поле):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% если фигура стоит на линии боя
</FONT><FONT FACE="Courier New">&#9;поле_линия(Напр,ПолеИз,Поле),
</FONT>&#9;!.
<FONT FACE="Courier New">фигура_под_боем2(ПолеИз,конём,Поле):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% если фигура стоит на поле боя коня
</FONT><FONT FACE="Courier New">&#9;поле_коня(конём,ПолеИз,Поле),
</FONT>&#9;!.

<FONT FACE="Courier New" COLOR="#008000">% фигура под боем которую ставим
</FONT><FONT FACE="Courier New">фигура_под_боем1(ПолеИз,Бъёт,Поле):-
&#9;фигура_под_боем2(ПолеИз,Бъёт,Поле),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% фигура под боем, которя уже стоит
</FONT><FONT FACE="Courier New">фигура_под_боем1(ПолеИз,Бъёт,Поле):-
&#9;фигура_под_боем2(Поле,Бъёт,ПолеИз),
</FONT>&#9;!.
&#9;
<FONT FACE="Courier New" COLOR="#008000">% фигура под боем
</FONT><FONT FACE="Courier New">фигура_под_боем(Фигура,Поле):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% перебор правил для фигуры
</FONT><FONT FACE="Courier New">&#9;правило(Фигура,Бъёт),
</FONT><FONT FACE="Courier New" COLOR="#008000">% перебор других фигур на доске
</FONT><FONT FACE="Courier New">&#9;стоит(_,ПолеИз),
</FONT><FONT FACE="Courier New" COLOR="#008000">% если Фигура с Правилом боя бьёт из своих координат данную клетку
% или наоборот
</FONT><FONT FACE="Courier New">&#9;фигура_под_боем1(ПолеИз,Бъёт,Поле),
</FONT><FONT FACE="Courier New" COLOR="#008000">% то фигура под боем
</FONT>&#9;!.&#9;
<FONT COLOR="#008000">%</FONT><FONT FACE="Courier New" COLOR="#008000"> удостовериться что фигура не под боем
</FONT><FONT FACE="Courier New">фигуры_не_под_боем(Фигура,Поле):-
&#9;not(фигура_под_боем(Фигура,Поле)),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% ставит одну фигуру на доску
</FONT><FONT FACE="Courier New">поставить_фигуру(Фигура):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% берет любое поле
</FONT><FONT FACE="Courier New">&#9;выбрать_поле_на_доске(Поле),
</FONT><FONT FACE="Courier New" COLOR="#008000">% если фигура на этом поле не будет побита
% и не побьёт другую фигуру
</FONT><FONT FACE="Courier New">&#9;фигуры_не_под_боем(Фигура,Поле),
</FONT><FONT FACE="Courier New" COLOR="#008000">% то поставим её на доску
</FONT><FONT FACE="Courier New">&#9;assertz(стоит(Фигура,Поле)),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% расставляет фигуры на доске
</FONT><FONT FACE="Courier New">поставить_фигуры1(Фигура):-
&#9;поставить_фигуру(Фигура),
&#9;поставить_фигуры1(Фигура),
</FONT>&#9;!.
<FONT FACE="Courier New">поставить_фигуры1(Фигура):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% вывести вариант с расстановкой
</FONT><FONT FACE="Courier New">&#9;nl,write("вариант для ", Фигура),
&#9;стоит(Фигура,Поле),
&#9;write(" ",Поле),
</FONT>&#9;fail.
&#9;
<FONT FACE="Courier New">поставить_фигуры(Фигура):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% начальная подготовка
% перебор всех полей
</FONT><FONT FACE="Courier New">&#9;выбрать_поле_на_доске(Поле),
</FONT><FONT FACE="Courier New" COLOR="#008000">% очистить знания
</FONT>&#9;ret<FONT FACE="Courier New">ractall(_,расстановки),
</FONT><FONT FACE="Courier New" COLOR="#008000">% поставить первую фигуру
</FONT><FONT FACE="Courier New">&#9;assertz(стоит(Фигура,Поле)),
&#9;поставить_фигуры1(Фигура),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">/* вызов предиката рсстановки */
</FONT><B><FONT COLOR="#0000ff">Goal</B></FONT><FONT FACE="Courier New"> поставить_фигуры(ферзь).
%
</PRE>
Пролог выдает варианты расстановки для данной фигуры (ферзь).
В данной программе не реализован поиск для коня. Разобрав поиск для других фигур – Вы сами сможете запросто его реализовать.
</FONT>
<P><A HREF="HTTP://icreator.ru/programming/"><U><FONT FACE="Times New Roman" COLOR="#0000ff">назад в раздел</U></FONT></A></P>
<P><A HREF="HTTP://www.icreator.ru/index.htm"><U><FONT FACE="Courier New" SIZE=2 COLOR="#0000ff">на главную страницу</U></FONT></A><FONT FACE="Courier New" SIZE=2><BR>
<!--Rating@Mail.ru COUNTER--><script language="JavaScript"><!--
d=document;a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<a href="http://top.mail.ru/jump?from=269943"'+
' target=_top><img src="http://top.list.ru/counter'+
'?id=269943;t=180;js='+js+a+';rand='+Math.random()+
'" alt="Рейтинг@Mail.ru"'+' border=0 height=15 width=88></a>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript></FONT><A HREF="http://top.mail.ru/jump?from=269943"><IMG SRC="http://top.list.ru/counter?js=na;id=269943;t=180" BORDER=0 WIDTH=88 HEIGHT=15 ALT="Рейтинг@Mail.ru"></A></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')//--></script><!--/COUNTER--><!--begin of Top100--><A HREF="http://top100.rambler.ru/top100/"><IMG SRC="http://counter.rambler.ru/top100.cnt?290358" BORDER=0 WIDTH=1 HEIGHT=1 ALT="Rambler's Top100"></A><!--end of Top100 code-->
<!-- HotLog -->
<script language="javascript">
hotlog_js="1.0";hotlog_d=document; hotlog_n=navigator;hotlog_rn=Math.random();
hotlog_n_n=(hotlog_n.appName.substring(0,3)=="Mic")?0:1;
hotlog_r=""+hotlog_rn+"&s=25682&im=26&r="+escape(hotlog_d.referrer)+"&pg="+
escape(window.location.href);
hotlog_d.cookie="hotlog=1"; hotlog_r+="&c="+(hotlog_d.cookie?"Y":"N");
hotlog_d.cookie="hotlog=1; expires=Thu, 01-Jan-70 00:00:01 GMT"</script>
<script language="javascript1.1">
hotlog_js="1.1";hotlog_r+="&j="+(navigator.javaEnabled()?"Y":"N")</script>
<script language="javascript1.2">
hotlog_js="1.2";hotlog_s=screen;
hotlog_r+="&wh="+hotlog_s.width+'x'+hotlog_s.height+"&px="+((hotlog_n_n==0)?
hotlog_s.colorDepth:hotlog_s.pixelDepth)</script>
<script language="javascript1.3">hotlog_js="1.3"</script>
<script language="javascript">hotlog_r+="&js="+hotlog_js;
hotlog_d.write("<a href=http://click.hotlog.ru/?25682 target=_top><img "+
"src=\"http://hit2.hotlog.ru/cgi-bin/hotlog/count?"+
hotlog_r+"&\" border=0 width=88 height=31 alt=HotLog></a>")</script>
<noscript><a href=http://click.hotlog.ru/?25682 target=_top><img
src="http://hit2.hotlog.ru/cgi-bin/hotlog/count?s=25682&im=26" border=0 
width="88" height="31" alt="HotLog"></a></noscript>
<!-- /HotLog --></BODY>
</HTML>
