<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>Логическое программирование</TITLE>
</HEAD>
<BODY BGCOLOR="#cdc6a7">

<FONT FACE="Courier New"><P>Сортировка фактов ПРОЛОГа</P>
<P><BR>
Ермолаев Д.С., Москва, </FONT><A HREF="http://www.icreator.ru/index.htm"><U><FONT FACE="Courier New" COLOR="#0000ff">www.icreator.ru</U></FONT></A></P>
<FONT FACE="Courier New"><P>09.04.2002</P>
</FONT><FONT FACE="Courier New"><P>Программа на ПРОЛОГе оперирует с базой знаний, состоящей из фактов. Как правило, поиск решения идет с помощью перебора всех возможных фактов. Это может привести к значительным потерям времени. Поэтому, иногда необходимо отсортировать факты так, что бы программа начинала просмотр знаний с наилучшего варианта для ускорения поиска решения. Здесь предложен алгоритм сортировки фактов языка ПРОЛОГ. Алгоритм и его реализация на Visual Prolog 5.2 была сделана мною за 3 часа. Я не знаю какой это метод, потому как сам</FONT><FONT FACE="Courier New"> </FONT><FONT FACE="Courier New">его придумал. Я слышал что есть метод с какими-то пузырьками, возможно это его подобие :)</P>
</FONT><PRE>------------------------------------

<FONT COLOR="#0000ff">domains
</FONT><FONT FACE="Courier New">ИмяЗаписи = string
НомерЗаписи, ЗначениеЗаписи = integer
МояЗапись=моя_запись(НомерЗаписи, ИмяЗаписи, ЗначениеЗаписи); пусто
</FONT>
<FONT COLOR="#0000ff">database</FONT><FONT FACE="Courier New"> - мои_записи
мз(МояЗапись)
</FONT>
<FONT COLOR="#0000ff">predicates
</FONT><FONT FACE="Courier New">показать_мои_записи
значение_записи(МояЗапись,ЗначениеЗаписи)
запись_выбрать(МояЗапись З1, МояЗапись З2, МояЗапись Вставить, МояЗапись Наверх)
запись_вставить(МояЗапись)
сортировка(МояЗапись Вниз, МояЗапись Вверх) - (i,o)
сортировка
откат
</FONT>
<FONT COLOR="#0000ff">clauses
</FONT>
<FONT FACE="Courier New">откат:-fail.
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% взять значение записи
</FONT><FONT FACE="Courier New">значение_записи(моя_запись(_,_,Значение),Значение):-!</FONT>.

<FONT FACE="Courier New" COLOR="#008000">% выбрать какую запись добавить, а какую передать наверх
</FONT><FONT FACE="Courier New">запись_выбрать(Запись1,пусто,пусто,Запись1):-!.
запись_выбрать(Запись1,Запись2,Запись1,Запись2):-
&#9;значение_записи(Запись1,Значение1),
&#9;значение_записи(Запись2,Значение2),
&#9;Значение1&gt;Значение2,
</FONT>&#9;!.
<FONT FACE="Courier New">запись_выбрать(Запись1,Запись2,Запись2,Запись1):-
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% вставить факт обратно в базу знаний
</FONT><FONT FACE="Courier New">запись_вставить(пусто)</FONT>:-!.
<FONT FACE="Courier New">запись_вставить(Запись):-
&#9;asserta(мз(Запись)),
</FONT>&#9;!.

<FONT FACE="Courier New" COLOR="#008000">% сама сортировка
</FONT><FONT FACE="Courier New">сортировка(ЗаписьВниз,ЗаписьНаверх):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% выбрать запись из базы знаний
</FONT><FONT FACE="Courier New">&#9;retract(мз(Запись1)),
</FONT><FONT FACE="Courier New" COLOR="#008000">% определить какую из записей передать вниз,
% а какую возможно вставить в этом предикате
</FONT><FONT FACE="Courier New">&#9;запись_выбрать(ЗаписьВниз,Запись1,ЗаписьВниз1,ЗаписьВставить1),
</FONT><FONT FACE="Courier New" COLOR="#008000">% рекурсия сортировки вниз
</FONT><FONT FACE="Courier New">&#9;сортировка(ЗаписьВниз1,Запись2),
</FONT><FONT FACE="Courier New" COLOR="#008000">% определить какую запись вставить обратно в знания
% а какую передать наверх
</FONT><FONT FACE="Courier New">&#9;запись_выбрать(ЗаписьВставить1,Запись2,ЗаписьВставить,ЗаписьНаверх),
</FONT><FONT FACE="Courier New" COLOR="#008000">% выбранную запись на вставление - вставляем
</FONT><FONT FACE="Courier New">&#9;запись_вставить(ЗаписьВставить),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% конец фактов - запомним последний
</FONT><FONT FACE="Courier New">сортировка(Запись,пусто):-
&#9;запись_вставить(Запись),
</FONT>&#9;!.

<FONT FACE="Courier New">показать_мои_записи:-
&#9;мз(Запись),
&#9;nl,write(Запись),
&#9;откат</FONT>.
<FONT FACE="Courier New">показать_мои_записи:-!.
</FONT>&#9;
<FONT FACE="Courier New">сортировка:-
&#9;сортировка(пусто,Запись),
&#9;запись_вставить(Запись),
&#9;показать_мои_записи,
</FONT>&#9;!.

<FONT FACE="Courier New">В базе знаний “проба.txt” содержатся факты в следующем виде и порядке:
мз(моя_запись(1,"я",23)).
мз(моя_запись(2,"ты",3)).
мз(моя_запись(3,"он",2)).
мз(моя_запись(4,"она",123)).
мз(моя_запись(5,"они",223)).
мз(моя_запись(6,"вы",213)).
мз(моя_запись(7,"кто",23)).
мз(моя_запись(8,"что",20)).
мз(моя_запись(9,"где",13)).
мз(моя_запись(10,"когда",12)).
мз(моя_запись(1,"я",5)).
мз(моя_запись(2,"ты",55)).
мз(моя_запись(3,"он",24)).
мз(моя_запись(4,"она",1)).
мз(моя_запись(5,"они",223)).
мз(моя_запись(6,"вы",33)).
мз(моя_запись(7,"кто",44)).
мз(моя_запись(8,"что",20)).
мз(моя_запись(9,"где",113)).
мз(моя_запись(10,"когда",4)).
</FONT>
<FONT FACE="Courier New">Сначала нужно загрузить факты в память с помощью команды:
</FONT><FONT COLOR="#0000ff">Goal</FONT><FONT FACE="Courier New"> consult("проба.txt",мои_записи).
</FONT>
<FONT FACE="Courier New">После этого можно запускать сортировку фактов:
</FONT><FONT COLOR="#0000ff">Goal</FONT><FONT FACE="Courier New"> сортировка. % отсортировать один раз</PRE>
</FONT><FONT FACE="Times New Roman" SIZE=2><P>Надо заметить что сортировка за один раз не расставляет все факты полностью по возрастанию Значения факта: здесь предикат “сортировка” - это лишь одна итерация сортировки. Однако за одну итерацию сразу несколько фактов перемещаются на довольно длинное расстояние в списке фактов. После нескольких выполнений предиката “сортировка” факты будут полностью отсортированы. Дело в том, что чтобы оценить окончание сортировки нужно сделать дополнительный предикат, который бы перезапускал сортировку в случае не полной сортировки фактов.</FONT><FONT FACE="Courier New" SIZE=2> </P>
</FONT><FONT FACE="Courier New" SIZE=2><P>Вот результаты сортировки входных фактов из файла “проба”:</P>
</FONT><PRE>

<B><FONT FACE="Courier New">Итерация 1.
</B>моя_запись(4,"она",1)
моя_запись(2,"ты",3)
моя_запись(3,"он",2)
моя_запись(1,"я",23)
моя_запись(4,"она",123)
моя_запись(6,"вы",213)
моя_запись(7,"кто",23)
моя_запись(8,"что",20)
моя_запись(9,"где",13)
моя_запись(10,"когда",12)
моя_запись(1,"я",5)
моя_запись(2,"ты",55)
моя_запись(3,"он",24)
моя_запись(10,"когда",4)
моя_запись(5,"они",223)
моя_запись(6,"вы",33)
моя_запись(7,"кто</FONT>",44)
<FONT FACE="Courier New">моя_запись(8,"что",20)
моя_запись(9,"где",113)
моя_запись(5,"они",223)
</FONT>
<B><FONT FACE="Courier New">Итерация 2.
</B>моя_запись(4,"она",1)
моя_запись(3,"он",2)
моя_запись(2,"ты",3)
моя_запись(10,"когда",4)
моя_запись(1,"я",23)
моя_запись(4,"она",123)
моя_запись(7,"кто",23)
моя_запись(8,"что",2</FONT>0)
<FONT FACE="Courier New">моя_запись(9,"где",13)
моя_запись(10,"когда",12)
моя_запись(1,"я",5)
моя_запись(2,"ты",55)
моя_запись(3,"он",24)
моя_запись(8,"что",20)
моя_запись(6,"вы",213)
моя_запись(6,"вы",33)
моя_запись(7,"кто",44)
моя_запись(9,"где",113)
моя_запись(5,"они",223)
моя_запись(5,"они",223)
</FONT>
<B><FONT FACE="Courier New">Итерация 3
</B>моя_запись(4,"она",1)
моя_запись(3,"он",2)
моя_запись(2,"ты",3)
моя_запись(10,"когда",4)
моя_запись(1,"я",5)
моя_запись(1,"я",23)
моя_запись(7,"кто",23)
моя_запись(8,"что",20)
моя_запись(9,"где",13)
моя_запись(10,"когда",</FONT>12)
<FONT FACE="Courier New">моя_запись(8,"что",20)
моя_запись(2,"ты",55)
моя_запись(3,"он",24)
моя_запись(6,"вы",33)
моя_запись(4,"она",123</FONT>)
<FONT FACE="Courier New">моя_запись(7,"кто",44)
моя_запись(9,"где",113)
моя_запись(6,"вы",213)
моя_запись(5,"они",223)
моя_запись(5,"они",223)
</FONT>
<B><FONT FACE="Courier New">Итерация </FONT>4
</B><FONT FACE="Courier New">моя_запись(4,"она",1)
моя_запись(3,"он",2)
моя_запись(2,"ты",3)
моя_запись(10,"когда",4)
моя_запись(1,"я",5)
моя_запись(10,"когда",12)
моя_запись(1,"я",23)
моя_запись(8,"что",20)
моя_запись(9,"где",13)
моя_запись(8,"что",20)
моя_запись(7,"кто",23)
моя_запись(3,"он"</FONT>,24)
<FONT FACE="Courier New">моя_запись(6,"вы",33)
моя_запись(7,"кто",44)
моя_запись(2,"ты",55)
моя_запись(9,"где",113)
моя_запись(4,"она</FONT>",123)
<FONT FACE="Courier New">моя_запись(6,"вы",213)
моя_запись(5,"они",223)
моя_запись(5,"они",223)
</FONT>
<B><FONT FACE="Courier New">Итерация 5
</B>моя_запись(4,"она",1)
моя_запись(3,"он",2)
моя_запись(2,"ты",3)
моя_запись(10,"когда",4)
моя_запись(1,"я",5)
моя_запись(10,"когда",12)
моя_запись(9,"где",13)
моя_запись(8,"что",20)
моя_запись(8,"что",20)
моя_запись(1,"я",23)
моя_запись(7,"кто",23)
моя_запись(3,"он",24)
моя_запись(6,"вы",33)
моя_запись(7,"кто</FONT>",44)
<FONT FACE="Courier New">моя_запись(2,"ты",55)
моя_запись(9,"где",113)
моя_запись(4,"она",123)
моя_запись(6,"вы",213)
моя_запись(5,"они",223)
моя_запись(5,"они",223)
</FONT> </PRE>
<FONT FACE="Courier New" SIZE=2><P>Как видно, на пятой итерации все факты полностью отсортированы. Хотя можно было бы уже остановиться и на третьей итерации, ведь лучшие факты уже находились в начале базы знаний, а точность их сортировки не так и важна в данной задаче. Недостаток алгоритма в том, что если в фактах есть много записей с одинаковыми значениями, то сортировка каждый раз будет сдвигать такие факты на одно место вверх.</P>
<P>А вот более сложный алгоритм. Здесь устранён недостаток, описанный выше. И теперь одинаковые записи сортируются как одна запись: если две записи равны, то они собираются в список и далее путешествуют по сортировке вместе. Если далее встретится еще равная запись, то и она присоединится к списку. Таким образом, сортировка производится</FONT><FONT FACE="Courier New" SIZE=2> </FONT><FONT FACE="Courier New" SIZE=2>за несколько итераций вне зависимости от количества одинаковых фактов.</P>
</FONT><PRE>
<FONT FACE="Courier New" COLOR="#008000">% пузырьки легкие всплывают, а тяжелые тонут
% а пузырьки одинаковые - цепляются к друг</FONT><FONT COLOR="#008000"> </FONT><FONT FACE="Courier New" COLOR="#008000">дружке
</FONT><FONT COLOR="#0000ff">domains
</FONT><FONT FACE="Courier New">ИмяЗаписи = string
НомерЗаписи, ЗначениеЗаписи = integer
МояЗапись=моя_запись(НомерЗаписи, ИмяЗаписи, ЗначениеЗаписи);
  мои_записи(МоиЗаписи); пусто
МоиЗаписи = МояЗапись*
</FONT>
<FONT COLOR="#0000ff">database</FONT><FONT FACE="Courier New"> - мои_записи
мз(МояЗапись)
</FONT>
<FONT COLOR="#0000ff">predicates
</FONT><FONT FACE="Courier New">показать_мои_записи
значение_записи(МояЗапись,ЗначениеЗаписи)
запись_выбрать(МояЗапись З1, МояЗапись З2, МояЗапись Вставить, МояЗапись Наверх)
запись_вставить(МояЗапись)
записи_вставить(МоиЗаписи)
сортировка(МояЗапись Вниз, МояЗапись Вверх) - (i</FONT>,o)
<FONT FACE="Courier New">сортировка
запись_выбрать_вниз(МояЗапись, МояЗапись, МояЗапись Вниз, МояЗапись)
запись_выбрать_вверх(МояЗапись, МояЗапись, МояЗапись, МояЗапись Вверх)
записи_сложить(МояЗапись,МояЗапись,МояЗапись) - (i,i,o)
</FONT>
<FONT COLOR="#0000ff">clauses
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% сложить две записи с одинаковым значением
</FONT><FONT FACE="Courier New">записи_сложить(Запись1,Запись2,мои_записи([Запись1,Запись2])):-&#9;!.
</FONT>&#9;
<FONT FACE="Courier New" COLOR="#008000">% взять значение записи
</FONT><FONT FACE="Courier New">значение_записи(моя_запись(_,_,Значение),Значение):-!.
значение_записи(мои_записи([Запись|_]),Значение):-значение_записи(Запись,Значение),!.
</FONT><FONT COLOR="#008000">
</FONT><FONT FACE="Courier New" COLOR="#008000">% выбрать какую запись добавить, а какую передать далее
</FONT><FONT FACE="Courier New">запись_выбрать(Запись1,Запись2,Запись1,Запись2):-
&#9;значение_записи(Запись1,Значение1),
&#9;значение_записи(Запись2,Значение2),
&#9;Значение1Значение2,
</FONT>&#9;!.
<FONT FACE="Courier New">запись_выбрать(Запись1,Запись2,Запись2,Запись1):-!.
</FONT>
<FONT FACE="Courier New" COLOR="#008000">% если записи равны, то их обоих нужно собрать в список и тащить вниз
</FONT><FONT FACE="Courier New">запись_выбрать_вниз(Запись1,Запись2,ЗаписьВниз,пусто):-
&#9;значение_записи(Запись1,Значение1),
&#9;значение_записи(Запись2,Значение2),
&#9;Значение1=Значение2,
&#9;записи_сложить(Запись1,Запись2,ЗаписьВниз),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% если не равны, то обычное сравнение
</FONT><FONT FACE="Courier New">запись_выбрать_вниз(пусто,Запись,Запись,пусто):-!.
запись_выбрать_вниз(Запись,пусто,Запись,пусто):-!.
запись_выбрать_вниз(Запись1,Запись2,ЗаписьВниз,ЗаписьВверх):-
&#9;запись_выбрать(Запись1,Запись2,ЗаписьВниз,ЗаписьВверх),
</FONT>&#9;!.
<FONT COLOR="#008000">
</FONT><FONT FACE="Courier New" COLOR="#008000">% если записи равны, то их обоих нужно собрать в список и тащить вверх
</FONT><FONT FACE="Courier New">запись_выбрать_вверх(Запись1,Запись2,пусто,ЗаписьВверх):-
&#9;значение_записи(Запись1,Значение1),
&#9;значение_записи(Запись2,Значение2),
&#9;Значение1=Значение2,
&#9;записи_сложить(Запись1,Запись2,ЗаписьВверх),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% если не равны, то обычное сравнение
</FONT><FONT FACE="Courier New">запись_выбрать_вверх(Запись,пусто,пусто,Запись):-!.
запись_выбрать_вверх(пусто,Запись,пусто,Запись):-!.
запись_выбрать_вверх(Запись1,Запись2,ЗаписьВниз,ЗаписьВверх):-
&#9;запись_выбрать(Запись1,Запись2,ЗаписьВниз,ЗаписьВверх),
</FONT>&#9;!.
<FONT COLOR="#008000">
</FONT><FONT FACE="Courier New" COLOR="#008000">% вставить список записей
</FONT><FONT FACE="Courier New">записи_вставить([Запись|Записи]):-
&#9;запись_вставить(Запись),
&#9;записи_вставить(Записи),
</FONT>&#9;!.
<FONT FACE="Courier New">записи_вставить([]):-!.
</FONT><FONT COLOR="#008000">
</FONT><FONT FACE="Courier New" COLOR="#008000">% вставить запись или список записей
</FONT><FONT FACE="Courier New">запись_вставить(пусто):-!.
запись_вставить(мои_записи(Записи)):-
&#9;записи_вставить(Записи),
</FONT>&#9;!.
<FONT FACE="Courier New">запись_вставить(Запись):-
&#9;asserta(мз(Запись)),
</FONT>&#9;!.

<FONT FACE="Courier New" COLOR="#008000">% сама сортировка фактов
</FONT><FONT FACE="Courier New">сортировка(ЗаписьВниз,ЗаписьНаверх):-
</FONT><FONT FACE="Courier New" COLOR="#008000">% вытащить текущий факт из базы
</FONT><FONT FACE="Courier New">&#9;retract(мз(Запись1)),
</FONT><FONT FACE="Courier New" COLOR="#008000">% посмотреть, что далее вниз пойдет
</FONT><FONT FACE="Courier New">&#9;запись_выбрать_вниз(ЗаписьВниз,Запись1,ЗаписьВниз1,ЗаписьВставить1),
</FONT><FONT FACE="Courier New" COLOR="#008000">% вызвать рекурсию сортировки (продолжим далее)
</FONT><FONT FACE="Courier New">&#9;сортировка(ЗаписьВниз1,ЗаписьНаверх1),
</FONT><FONT FACE="Courier New" COLOR="#008000">% посмотреть, что вернуть наверх, а что положить в базу знаний
</FONT><FONT FACE="Courier New">&#9;запись_выбрать_вверх(ЗаписьВставить1,ЗаписьНаверх1,ЗаписьВставить,ЗаписьНаверх),
&#9;запись_вставить(ЗаписьВставить),
</FONT>&#9;!.
<FONT FACE="Courier New" COLOR="#008000">% конец фактов - запомним последний
</FONT><FONT FACE="Courier New">сортировка(Запись,пусто):-
&#9;запись_вставить(Запись),
</FONT>&#9;!.
<FONT FACE="Courier New">% для показа записей на экран
показать_мои_записи:-
&#9;мз(Запись1),
&#9;nl,write(Запись1),
&#9;откат.
показать_мои_записи:-!.
</FONT>&#9;
<FONT FACE="Courier New" COLOR="#008000">% вызов сортировки
</FONT><FONT FACE="Courier New">сортировка:-
&#9;сортировка(пусто,Запись),
&#9;запись_вставить(Запись),
&#9;показать_мои_записи,
%&#9;повторить,
</FONT>&#9;!.
<FONT FACE="Courier New">вот результаты сортировки</FONT>:
<B><FONT FACE="Courier New">Итерация 1
</B>Моя</FONT>_<FONT FACE="Courier New">запись(4,"она",1)
моя_запись(2,"ты",</FONT>3)
<FONT FACE="Courier New">моя_запись(3,"он",2)
моя_запись(1,"я",23)
моя_запись(4,"она",123)
моя_запись(6,"вы",213)
моя_запись(7,"кто",23)
моя_запись(8,"что",20)
моя_запись(9,"где",13)
моя_запись(10,"когда",12)
моя_запись(1,"я",5)
моя_запись(2,"ты",55)
моя_запись(3,"он",24)
моя_запись(10,"когда",4)
моя_запись(6,"вы",33)
моя_запись(7,"кто",44)
моя_запись(8,"что",20)
моя_запись(9,"где</FONT>",113)
<FONT FACE="Courier New">моя_запись(5,"они",223)
моя_запись(5,"они",223)
<B>Итерация 2
</B>моя_запись(4,"она",1)
моя_запись(3,"он",2)
моя_запись(2,"ты",3)
моя_запись(10,"когда"</FONT>,4)
<FONT FACE="Courier New">моя_запись(1,"я",23)
моя_запись(4,"она",123)
моя_запись(7,"кто",23)
моя_запись(8,"что",20)
моя_запись(9,"где",13)
моя_запись(10,"когда",12)
моя_запись(1,"я",5)
моя_запись(2,"ты",55)
моя_запись(3,"он",24)
моя_запись(8,"что",20)
моя_запись(6,"вы",33)
моя_запись(7,"кто",44)
моя_запись(9,"где",113)
моя_запись(6,"вы",213)
моя_запись(5,"они",223)
моя_запись(5,"они",223)
<B>Итерация 3
</B>моя_запись(4,"она",1)
моя_запись(3,"он",2)
моя_запись(2,"ты",3)
моя_запись(10,"когда",4)
моя_запись(1,"я",5)
моя_запись(1,"я",23)
моя_запись(7,"кто",23)
моя_запись(8,"что",20)
моя_запись(9,"где",13)
моя_запись(10,"когда",12)
моя_запись(8,"что",20)
моя_запись(2,"ты",55)
моя_запись(3,"он",24)
моя_запись(6,"вы",33)
моя_запись(7,"кто",44)
моя_запись(9,"где",113)
моя_запись(4,"она",123)
моя_запись(6,"вы",213)
моя_запись(5,"они",223)
моя_запись(5,"они",223)
<B>Итерация 4
</B>моя_запись(4,"она",1)
моя_запись(3,"он",2</FONT>)
<FONT FACE="Courier New">моя_запись(2,"ты",3)
моя_запись(10,"когда",4)
моя_запись(1,"я",5)
моя_запись(10,"когда",12)
моя_запись(8,"что",20)
моя_запись(9,"где</FONT>",13)
<FONT FACE="Courier New">моя_запись(8,"что",20)
моя_запись(7,"кто",23)
моя_запись(1,"я",23)
моя_запись(3,"он",24)
моя_запись(6,"вы",33)
моя_запись(7,"кто",44)
моя_запись(2,"ты",55)
моя_запись(9,"где",113)
моя_запись(4,"она",123)
моя_запись(6,"вы",213)
моя_запись(5,"они",223)
моя_запись(5,"они",223)
<B>Итерация 5
</B>моя_запись(4,"она",1)
моя_запись(3,"он",2)
моя_запись(2,"ты",3)
моя_запись(10,"когда",</FONT>4)
<FONT FACE="Courier New">моя_запись(1,"я",5)
моя_запись(10,"когда",12)
моя_запись(9,"где",13)
моя_запись(8,"что",20)
моя_запись(8,"что",20)
моя_запись(1,"я"</FONT>,23)
<FONT FACE="Courier New">моя_запись(7,"кто",23)
моя_запись(3,"он",24)
моя_запись(6,"вы",33)
моя_запись(7,"кто",44)
моя_запись(2,"ты",55)
моя_запись(9,"где",113)
моя_запись(4,"она",123)
моя_запись(6,"вы",213)
моя_запись(5,"они",223)
моя_запись(5,"они",223)
</FONT>%</PRE>
<FONT FACE="Times New Roman" SIZE=2><P>Вообще, есть классическая сортировка с помощью бинарных деревьев. Такая сортировка работает быстрее описанного выше метода. Но ее недостаток в том, что она выполняет полную сортировку до полного упорядочивания всех элементов списка. А предложенная мной сортировка делается не полностью, лишь увеличивая вероятность появления нужного факта в начале базы фактов ПРОЛОГа Мною была проведена тестовая оценка классической сортировки и предложенной:</P>
<P>Так для количества записей 100 в базе, классическая сортировка делает 800 сравнений, а предложенная в статье (за два прохода): 378. Для 400 записей, соответственно: 11600 и 1500 (за два прохода). Однако если учесть, что время на выполнение одного сравнения в предложенном методе уходит больше и количество проходов при увеличении записей возрастает, выгодность классического метода увеличивается. Вот классический пример сортировки на ПРОЛОГе: </P>
</FONT><PRE>
=========================
<FONT FACE="Courier New" COLOR="#008000">% сортировка с использованием Reference Domains
% То есть когда значение предает как ссылка
</FONT><FONT COLOR="#008000">
</FONT><FONT FACE="Courier New" COLOR="#008000">% файл пример находится в ch11e04.pro к VIP5.5
% и показывает как использовать ссылочные значения
% в классической сортировке по методу бинарного дерева
</FONT>
/* Program ch11e05.pro */

<FONT COLOR="#0000ff">DOMAINS
</FONT>
tree = reference t(val, tree, tree)
val  = integer
list = integer*

<FONT COLOR="#0000ff">PREDICATES
</FONT>
insert(integer,tree)
instree(list,tree)
nondeterm treemembers(integer,tree)
sort(list,list)

<FONT COLOR="#0000ff">CLAUSES
</FONT>
insert(Val,t(Val,_,_)):-!.
insert(Val,t(Val1,Tree,_)):-
&#9; Val&amp;gtVal1,
&#9;!,
&#9;insert(Val,Tree).

insert(Val,t(_,_,Tree)):-
&#9;insert(Val,Tree).

instree([],_).
instree([H|T],Tree):-
&#9;insert(H,Tree),
&#9;instree(T,Tree).

treemembers(_,T):-
&#9;free(T),
&#9;!,
&#9;fail.

treemembers(X,t(_,L,_)):-
&#9;treemembers(X,L).

treemembers(X,t(Refstr,_,_)):-
&#9;X = Refstr.

treemembers(X,t(_,_,R)):-
&#9;treemembers(X,R).

sort(L,L1):-
<FONT FACE="Times New Roman" COLOR="#008000">% рассортировывает элементы списка в бинарное дерево
</FONT>&#9;instree(L,Tree),
<FONT FACE="Times New Roman" COLOR="#008000">% преобразовывает бинарное дерево обратно в список
</FONT>&#9;findall(X,treemembers(X,Tree),L1).

<FONT COLOR="#0000ff">GOAL
</FONT>&#9;sort([3,6,1,4,5],L),
&#9;write("L=",L),nl.

<FONT FACE="Times New Roman" COLOR="#008000">% Здесь значения-ссылки используются только в домайне tree
</FONT></PRE>

<P><A HREF="HTTP://icreator.ru/programming/"><U><FONT FACE="Times New Roman" COLOR="#0000ff">назад в раздел</U></FONT></A></P>

<P><A HREF="HTTP://www.icreator.ru/index.htm"><U><FONT FACE="Courier New" SIZE=2 COLOR="#0000ff">на главную страницу</U></FONT></A><FONT FACE="Courier New" SIZE=2><BR>
<!--Rating@Mail.ru COUNTER--><script language="JavaScript"><!--
d=document;a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<a href="http://top.mail.ru/jump?from=269943"'+
' target=_top><img src="http://top.list.ru/counter'+
'?id=269943;t=180;js='+js+a+';rand='+Math.random()+
'" alt="Рейтинг@Mail.ru"'+' border=0 height=15 width=88></a>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript><A HREF="http://top.mail.ru/jump?from=269943"><IMG SRC="http://top.list.ru/counter?js=na;id=269943;t=180" BORDER=0 WIDTH=88 HEIGHT=15 ALT="Рейтинг@Mail.ru"></A></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')//--></script><!--/COUNTER-->
<!-- HotLog -->
<script language="javascript">
hotlog_js="1.0";hotlog_d=document; hotlog_n=navigator;hotlog_rn=Math.random();
hotlog_n_n=(hotlog_n.appName.substring(0,3)=="Mic")?0:1;
hotlog_r=""+hotlog_rn+"&s=25682&im=26&r="+escape(hotlog_d.referrer)+"&pg="+
escape(window.location.href);
hotlog_d.cookie="hotlog=1"; hotlog_r+="&c="+(hotlog_d.cookie?"Y":"N");
hotlog_d.cookie="hotlog=1; expires=Thu, 01-Jan-70 00:00:01 GMT"</script>
<script language="javascript1.1">
hotlog_js="1.1";hotlog_r+="&j="+(navigator.javaEnabled()?"Y":"N")</script>
<script language="javascript1.2">
hotlog_js="1.2";hotlog_s=screen;
hotlog_r+="&wh="+hotlog_s.width+'x'+hotlog_s.height+"&px="+((hotlog_n_n==0)?
hotlog_s.colorDepth:hotlog_s.pixelDepth)</script>
<script language="javascript1.3">hotlog_js="1.3"</script>
<script language="javascript">hotlog_r+="&js="+hotlog_js;
hotlog_d.write("<a href=http://click.hotlog.ru/?25682 target=_top><img "+
"src=\"http://hit2.hotlog.ru/cgi-bin/hotlog/count?"+
hotlog_r+"&\" border=0 width=88 height=31 alt=HotLog></a>")</script>
<noscript><a href=http://click.hotlog.ru/?25682 target=_top><img
src="http://hit2.hotlog.ru/cgi-bin/hotlog/count?s=25682&im=26" border=0 
width="88" height="31" alt="HotLog"></a></noscript>
<!-- /HotLog -->
</BODY>
</HTML>
